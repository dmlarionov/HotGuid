HotGuid
=======
Generates time-ordered ID in Guid (UUID) format based on ushort shard code (region code). 

The feature of an ID generated by the this piece of software is that the sharding key can be extracted out of an ID anywhere in the distributed system. This is helpful if you use ID alone (without additional keys) to request an entity from a backend, but expect the backend to know which shard to look for the requested entity.

Why time-order is important?
----------------------------
When you massively generate transactional entities (like orders, offers, missions) and insert them to a database the order is important to avoid page splits in ordered storage structures (indexes and tables). The ordered key at least divides in half the cost an insert in respect of random key.

If your database is larger than a server memory size the ordered keys saves a lot, because caching is only effective if the hot points in a storage are stable. These point should be freshly added pages that are highly probably becomes read in the short time.

Check an articles:

- https://www.2ndquadrant.com/en/blog/sequential-uuid-generators/
- https://www.percona.com/blog/2019/11/22/uuids-are-popular-but-bad-for-performance-lets-discuss/

Why ushort for a sharding key?
------------------------------
First, the shorter non-random part of a UUID-like value is the less it affects collision probability for a key. Unfortunately, it affects because it takes space out of random and time-based parts.

Second, ushort is quite long to keep UN M.49 region codes (https://unstats.un.org/unsd/methodology/m49/), which might be a reasonable choice for data sharding key. Anyway, 65536 values for sharding key seems reasonable if have much less than 65536 nodes.

## How to use?

Generate a `Guid` for a given sharding key:

```csharp
var id = HotGuidGenerator.Instance.NewGuid(shardCode);
```

Take sharding key out of such Guid:

```csharp
var shardCode = id.ExtractShardCode();
```

Don't extract sharding key out from `Guid` not generated by HotGuidGenerator, you'll get meaningless one.

Gratitude
---------

This code is mostly borrowed from SequentialGuid project (https://github.com/buvinghausen/SequentialGuid/blob/master/README.md), which resembles MongoDB object Id in Guid. I really appreciate Brian Buvinghausen work, which includes a bunch of tests that kept me a lot of time to make reliable fork project by just copying and pasting what I need.